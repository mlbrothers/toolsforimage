{% extends "fr/base.html" %}

{% block title %}Effets d'Image en ligne ToolsForImage - Outils de Retouche d'Image en Ligne Gratuits{% endblock %}

{% block meta_description %}
<meta name="description" content="Appliquez divers effets à vos images avec ToolsForImage. Améliorez vos photos avec des filtres comme le noir et blanc, le flou, le netteté et plus.">
{% endblock %}

{% block content %}
<h1>Outil Gratuit d'Effets d'Image</h1>
<p>Améliorez vos images avec divers effets en utilisant ToolsForImage. Téléchargez une image, appliquez des effets et téléchargez le résultat.</p>
<p>Téléchargez votre fichier image et appliquez des effets instantanément. Choisissez votre image :</p>
<form id="effects-form" action="/apply-effects" method="post" enctype="multipart/form-data">
    <input type="file" id="image-upload" name="image" accept="image/*" style="display: none;" onchange="previewImage(event)">
    <button type="button" class="upload-button" onclick="document.getElementById('image-upload').click();">Télécharger depuis l'Ordinateur</button>
    <br>
    <canvas id="canvas"></canvas>
    <br>
    <div class="effects-container">
        <button type="button" class="effect-button" onclick="toggleEffect('grayscale')">Noir et Blanc</button>
        <button type="button" class="effect-button" onclick="toggleEffect('blur')">Flou</button>
        <button type="button" class="effect-button" onclick="toggleEffect('sharpen')">Netteté</button>
        <button type="button" class="effect-button" onclick="toggleEffect('sepia')">Sépia</button>
        <button type="button" class="effect-button" onclick="toggleEffect('invert')">Inverser</button>
        <button type="button" class="effect-button" onclick="toggleEffect('brightness')">Luminosité</button>
        <button type="button" class="effect-button" onclick="toggleEffect('contrast')">Contraste</button>
        <button type="button" class="effect-button" onclick="toggleEffect('saturation')">Saturation</button>
    </div>
    <br>
    <input type="hidden" id="effect-applied" name="effect" value="">
    <button type="submit" class="download-button" onclick="return validateImageSelection();">Télécharger l'Image Éditée</button>
</form>

<div class="info-container">
    <div class="info-section">
        <h2>Qu'est-ce que les Effets d'Image ?</h2>
        <p>Les effets d'image sont des filtres ou des ajustements appliqués aux photos pour améliorer leur apparence ou créer un style visuel spécifique. En utilisant différents effets, vous pouvez modifier les couleurs, la netteté, la luminosité d'une image, etc., lui donnant un tout nouveau look. Que vous visiez une ambiance vintage ou une touche moderne, les effets d'image vous permettent de transformer vos photos de manière créative.</p>
    </div>
    <div class="info-section">
        <h2>Pourquoi Appliquer des Effets d'Image ?</h2>
        <p>Appliquer des effets à vos images peut faire ressortir le meilleur de vos photos. Des effets comme le noir et blanc ou le sépia peuvent évoquer certaines émotions ou périodes, tandis que d'autres comme les ajustements de luminosité et de contraste aident à peaufiner la qualité globale de l'image. Les effets d'image sont utiles pour créer une cohérence esthétique, améliorer l'ambiance et faire ressortir les images, que ce soit pour un usage personnel, les réseaux sociaux ou des projets professionnels. En appliquant des effets, vous pouvez donner à vos images le look parfait pour n'importe quelle occasion.</p>
    </div>
    <div class="info-section">
        <h2>Comment Utiliser Notre Outil d'Effets d'Image</h2>
        <p>Notre outil d'effets d'image est facile à utiliser. Il vous suffit de télécharger votre photo, de choisir un ou plusieurs effets parmi les options disponibles, et de cliquer pour appliquer ! Vous pouvez améliorer vos images avec une variété d'effets :</p>
        <ul>
            <li><strong>Noir et Blanc (Grayscale) :</strong> Supprimez toutes les couleurs de votre image, lui donnant un look monochrome classique.</li>
            <li><strong>Flou :</strong> Appliquez un effet de mise au point douce, rendant l'image plus lisse ou en mettant en avant des zones spécifiques en floutant d'autres.</li>
            <li><strong>Netteté :</strong> Augmentez la définition de l'image, rendant les bords plus nets et améliorant la clarté.</li>
            <li><strong>Sépia :</strong> Ajoutez une teinte brune chaude à votre image, évoquant une ambiance vintage et nostalgique.</li>
        </ul>
    </div>
    
    <div class="info-section">
        <h2>D'autres Effets que Vous Pouvez Appliquer</h2>
        <p>Explorez des options supplémentaires pour peaufiner vos images et obtenir le look désiré :</p>
        <ul>
            <li><strong>Inverser :</strong> Retournez les couleurs de votre image pour un effet négatif frappant.</li>
            <li><strong>Luminosité :</strong> Ajustez les niveaux de lumière dans votre image pour la rendre plus claire ou plus sombre, selon l'ambiance désirée.</li>
            <li><strong>Contraste :</strong> Changez l'équilibre entre les zones claires et sombres, donnant à votre photo un look plus dramatique ou subtil.</li>
            <li><strong>Saturation :</strong> Contrôlez l'intensité des couleurs, les rendant plus vives ou atténuées, selon l'impact visuel souhaité.</li>
        </ul>
        <p>Notre outil fonctionne sur tous les appareils et garantit que vos photos conservent leur qualité tout en appliquant ces effets, vous donnant un contrôle total sur le résultat final.</p>
    </div>
    
    <div class="info-section">
        <h2>Avantages d'Utiliser Notre Outil d'Effets d'Image</h2>
        <p>En utilisant notre outil d'effets d'image, vous pouvez profiter d'un large éventail d'avantages :</p>
        <ul>
            <li><strong>Contrôle Créatif :</strong> Expérimentez avec divers effets pour atteindre le style artistique souhaité.</li>
            <li><strong>Interface Facile à Utiliser :</strong> Appliquez et ajustez les effets sans effort grâce à un design convivial.</li>
            <li><strong>Pas de Logiciel Nécessaire :</strong> Accédez à l'outil directement depuis votre navigateur sans besoin de logiciel supplémentaire.</li>
            <li><strong>Aperçu Instantané :</strong> Voyez à quoi ressemble votre photo avec chaque effet appliqué en temps réel.</li>
            <li><strong>Sortie de Haute Qualité :</strong> Assurez-vous que vos photos conservent leur netteté et leurs détails, même après l'application des effets.</li>
        </ul>
    </div>
    <div class="info-section">
        <h2>Cas d'Utilisation Courants pour les Effets d'Image</h2>
        <p>Les effets d'image sont couramment utilisés dans divers scénarios, tels que :</p>
        <ul>
            <li><strong>Contenu des Réseaux Sociaux :</strong> Améliorez vos photos avec des effets qui les font ressortir sur des plateformes comme Instagram et Facebook.</li>
            <li><strong>Édition de Photographie :</strong> Appliquez les touches finales à des projets photographiques professionnels pour améliorer leur impact visuel.</li>
            <li><strong>Marketing et Publicité :</strong> Ajustez le ton et l'ambiance des images pour les aligner avec le branding et le contenu promotionnel.</li>
            <li><strong>Projets Personnels :</strong> Transformez vos photos personnelles en pièces artistiques en expérimentant avec différents effets.</li>
        </ul>
    </div>
</div>

<style>
    h1 {
        color: var(--secondary-color);
        font-family: var(--font-family);
        text-align: center;
    }

    main {
        padding: 2em;
        text-align: center;
    }

    .upload-button {
        background-color: var(--link-hover-color); 
        color: var(--background-color);
        padding: 20px 40px;
        border: none;
        cursor: pointer;
        font-size: 20px;
        transition: transform 0.3s;
        border-radius: 5px;
    }

    .upload-button:hover {
        transform: scale(1.1);
    }

    .effect-button {
        background-color: var(--link-hover-color); 
        color: var(--background-color);
        border: 2px solid var(--box-hover-color);
        padding: 10px 20px;
        cursor: pointer;
        font-size: 18px;
        margin: 10px;
        transition: transform 0.3s;
        border-radius: 5px;
    }

    .effect-button.active {
        background-color: var(--box-hover-color);
        color: var(--background-color);
    }

    .effect-button:hover {
        transform: scale(1.1);
        background-color: var(--box-hover-text-color);
    }

    canvas {
        max-width: 100%;
        margin: 20px auto;
        display: none;
        border: 2px solid var(--box-hover-color);
        border-radius: 5px;
    }

    .download-button {
        background-color: var(--background-color);
        color: var(--box-hover-color);
        border: 2px solid var(--box-hover-color);
        padding: 10px 20px;
        cursor: pointer;
        font-size: 20px;
        transition: transform 0.3s;
        margin-top: 10px;
        margin-bottom: 20px;
        border-radius: 5px;
    }

    .effects-container {
        margin-top: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
    }

    li {
        line-height: 1.6;
    }

    
</style>

<script>
    let canvas, ctx, img, originalImageData;
    let activeEffects = [];

    function validateImageSelection() {
        const imageUpload = document.getElementById('image-upload');
        if (!imageUpload.value) {
            alert('Please select an image to upload.');
            return false;
        }
        document.getElementById('effect-applied').value = getAppliedEffects();
        return true;
    }

    function getAppliedEffects() {
        return activeEffects.join(',');
    }

    function previewImage(event) {
        const file = event.target.files[0];
        if (file) {
            img = new Image();
            img.onload = function() {
                canvas = document.getElementById('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, img.width, img.height);
                canvas.style.display = 'block';
                originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            }
            img.src = URL.createObjectURL(file);
        }
    }

    function toggleEffect(effect) {
        if (!canvas) {
            alert('Please upload an image first.');
            return;
        }

        const index = activeEffects.indexOf(effect);
        if (index > -1) {
            activeEffects.splice(index, 1);
        } else {
            activeEffects.push(effect);
        }

        const button = document.querySelector(`.effect-button[onclick="toggleEffect('${effect}')"]`);
        button.classList.toggle('active');

        applyEffects();
    }

    function applyEffects() {
        ctx.putImageData(originalImageData, 0, 0);
        let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;
        console.log("HI", applyEffects);
        if (activeEffects.includes('grayscale')) {
            for (let i = 0; i < data.length; i += 4) {
                const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                data[i] = data[i + 1] = data[i + 2] = avg;
            }
        }

        if (activeEffects.includes('blur')) {
            // Apply a simplified blur effect
            const blurRadius = 3;
            const width = canvas.width;
            const height = canvas.height;
            
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    let r = 0, g = 0, b = 0, count = 0;
                    
                    for (let dy = -blurRadius; dy <= blurRadius; dy++) {
                        for (let dx = -blurRadius; dx <= blurRadius; dx++) {
                            const nx = x + dx;
                            const ny = y + dy;
                            
                            if (nx >= 0 && nx < width && ny >= 0 && ny < height) {
                                const i = (ny * width + nx) * 4;
                                r += data[i];
                                g += data[i + 1];
                                b += data[i + 2];
                                count++;
                            }
                        }
                    }
                    
                    const i = (y * width + x) * 4;
                    data[i] = r / count;
                    data[i + 1] = g / count;
                    data[i + 2] = b / count;
                }
            }
        }

        if (activeEffects.includes('sharpen')) {
            sharpen(imageData, canvas.width, canvas.height);
        }

        if (activeEffects.includes('sepia')) {
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                data[i] = (r * 0.393) + (g * 0.769) + (b * 0.189);
                data[i + 1] = (r * 0.349) + (g * 0.686) + (b * 0.168);
                data[i + 2] = (r * 0.272) + (g * 0.534) + (b * 0.131);
            }
        }

        if (activeEffects.includes('invert')) {
            for (let i = 0; i < data.length; i += 4) {
                data[i] = 255 - data[i];
                data[i + 1] = 255 - data[i + 1];
                data[i + 2] = 255 - data[i + 2];
            }
        }

        if (activeEffects.includes('brightness')) {
            const brightnessValue = 50;
            for (let i = 0; i < data.length; i += 4) {
                data[i] += brightnessValue;
                data[i + 1] += brightnessValue;
                data[i + 2] += brightnessValue;
            }
        }

        if (activeEffects.includes('contrast')) {
            const contrastFactor = 1.5;
            for (let i = 0; i < data.length; i += 4) {
                data[i] = ((data[i] - 128) * contrastFactor) + 128;
                data[i + 1] = ((data[i + 1] - 128) * contrastFactor) + 128;
                data[i + 2] = ((data[i + 2] - 128) * contrastFactor) + 128;
            }
        }

        if (activeEffects.includes('saturation')) {
            const saturationFactor = 1.5;
            for (let i = 0; i < data.length; i += 4) {
                const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                data[i] = avg + (data[i] - avg) * saturationFactor;
                data[i + 1] = avg + (data[i + 1] - avg) * saturationFactor;
                data[i + 2] = avg + (data[i + 2] - avg) * saturationFactor;
            }
        }

        ctx.putImageData(imageData, 0, 0);
    }

    function boxBlur(imageData, width, height, radius) {
        const pixels = imageData.data;
        const temp = new Uint8ClampedArray(pixels.length);
        const boxSize = (radius * 2 + 1) * (radius * 2 + 1);

        for (let y = 0; y < height; y++) {
            for (let x = 0; x < width; x++) {
                let r = 0, g = 0, b = 0;

                for (let ky = -radius; ky <= radius; ky++) {
                    for (let kx = -radius; kx <= radius; kx++) {
                        const px = Math.min(width - 1, Math.max(0, x + kx));
                        const py = Math.min(height - 1, Math.max(0, y + ky));
                        const i = (py * width + px) * 4;
                        r += pixels[i];
                        g += pixels[i + 1];
                        b += pixels[i + 2];
                    }
                }

                const i = (y * width + x) * 4;
                temp[i] = r / boxSize;
                temp[i + 1] = g / boxSize;
                temp[i + 2] = b / boxSize;
                temp[i + 3] = pixels[i + 3];
            }
        }

        for (let i = 0; i < pixels.length; i++) {
            pixels[i] = temp[i];
        }
    }

    function sharpen(imageData, width, height) {
        const pixels = imageData.data;
        const temp = new Uint8ClampedArray(pixels.length);
        const kernel = [
            0, -1, 0,
            -1, 5, -1,
            0, -1, 0
        ];

        for (let y = 1; y < height - 1; y++) {
            for (let x = 1; x < width - 1; x++) {
                const i = (y * width + x) * 4;
                let r = 0, g = 0, b = 0;

                for (let ky = -1; ky <= 1; ky++) {
                    for (let kx = -1; kx <= 1; kx++) {
                        const ki = ((y + ky) * width + (x + kx)) * 4;
                        const kw = kernel[(ky + 1) * 3 + (kx + 1)];
                        r += pixels[ki] * kw;
                        g += pixels[ki + 1] * kw;
                        b += pixels[ki + 2] * kw;
                    }
                }

                temp[i] = Math.min(255, Math.max(0, r));
                temp[i + 1] = Math.min(255, Math.max(0, g));
                temp[i + 2] = Math.min(255, Math.max(0, b));
                temp[i + 3] = pixels[i + 3];
            }
        }

        for (let i = 0; i < pixels.length; i++) {
            pixels[i] = temp[i];
        }
    }
</script>
{% endblock %}
